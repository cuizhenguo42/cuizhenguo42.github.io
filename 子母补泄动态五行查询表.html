<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>经络穴位一键查询-网页版</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "微软雅黑", "宋体", Arial, sans-serif;
            font-size: 14px;
        }
        body {
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        /* 标签页样式 */
        .tab-nav {
            display: flex;
            border-bottom: 2px solid #1890ff;
            margin-bottom: 20px;
        }
        .tab-item {
            padding: 10px 20px;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            background: #e6f7ff;
            border: 1px solid #1890ff;
            border-bottom: none;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            margin-right: 5px;
        }
        .tab-item.active {
            background: #1890ff;
            color: #fff;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        /* 查询区样式 */
        /* 查询区样式（修改后：确保垂直+横向排列） */
        .query-area {
            display: flex;
            flex-direction: column; /* 整体垂直排列（标题、查询项、按钮） */
            align-items: flex-start; /* 左对齐，避免拉伸 */
            margin-bottom: 20px;
            gap: 12px; /* 标题、查询项、按钮之间的垂直间距 */
        }

        .query-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin: 0; /* 清除默认边距 */
        }

        /* 包裹两个查询项的容器：垂直排列查询项 */
        .query-items-container {
            display: flex;
            flex-direction: column;
            gap: 10px; /* 两个查询项之间的垂直间距 */
            width: 100%; /* 占满宽度，排版更整齐 */
        }

        /* 单个查询项：标签+选择框 横向排列 */
        .query-item {
            display: flex;
            flex-direction: row; /* 强制横向排列（覆盖原有column） */
            align-items: center; /* 标签和选择框垂直居中 */
            gap: 8px; /* 标签与选择框的横向间距 */
            width: fit-content; /* 自适应宽度，避免拉伸 */
        }

        .query-item label {
            font-weight: 500;
            width: 80px; /* 固定标签宽度，让选择框对齐更整齐 */
            text-align: right; /* 标签右对齐，视觉更规整 */
        }

        .query-item select {
            padding: 6px 10px;
            width: 200px;
            border: 1px solid #ccc;
            border-radius: 4px;
            outline: none;
            cursor: pointer;
        }

        .query-item select:focus {
            border-color: #1890ff;
        }

        .btn-query {
            padding: 12px 30px;
            background: #1890ff;
            color: #fff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 5px;
            transition: background 0.3s; /* 新增：颜色过渡更丝滑 */
        }

        .btn-query:hover {
            background: #40a9ff;
        }
        /* 结果区样式 - 还原原Excel配色和布局 */
        .result-area {
            border-collapse: collapse;
            width: 100%;
        }
        /* 新增：按钮点击后的颜色样式 */
        .btn-query.clicked {
            background: #d9097b; /* 深蓝色，可自行修改成想要的颜色 */
        }
        .result-cell {
            border: 1px solid #000;
            padding: 8px;
            vertical-align: middle;
            text-align: left;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .result-title {
            font-weight: bold;
            background-color: #fff;
            text-align: center;
            font-size: 16px;
            padding: 10px;
        }
        .result-label {
            font-weight: bold;
            width: 18%;
            min-width: 150px;
        }
        /* 结果区配色 - 与原VBA完全一致 */
        .color-green { background-color: #ccffcc; }  /* 浅绿 */
        .color-pink { background-color: #ffc0cb; }  /* 粉红 */
        .color-blue { background-color: #b4dcff; }  /* 浅蓝 */
        .color-yellow { background-color: #ffffcc; }/* 淡金 */
        .color-input { background-color: #ffffcc; }/* 输入区标黄 */
        /* 汇总表样式 */
        /* 汇总表样式 - 新增冻结表头逻辑 */
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            /* 核心修改：开启垂直滚动 + 限制表格高度（可自定义） */
            overflow-y: auto;
            overflow-x: auto;
            display: block;
            max-height: 600px; /* 表格最大高度，超出则滚动，可根据需求调整（比如500px） */
        }

        /* 表头单元格 - 冻结核心样式 */
        .summary-th {
            border: 1px solid #000;
            padding: 8px;
            background-color: #b4dcff; /* 表头背景色，必须设置，避免被内容穿透 */
            font-weight: bold;
            text-align: center;
            white-space: pre-wrap;
            font-size: 11px;
            /* 关键：粘性定位，top:0 表示吸附在容器顶部 */
            position: sticky;
            top: 0;
            /* 提升层级，确保表头在内容上方 */
            z-index: 10;
        }

        .summary-td {
            border: 1px solid #000;
            padding: 6px;
            vertical-align: middle;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 12px;
            /* 可选：给内容单元格加背景色，区分表头 */
            background-color: #fff;
        }
        /* 提示框样式 */
        .alert {
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            display: none;
        }
        .alert-error {
            background-color: #fff2f2;
            border: 1px solid #ff4d4f;
            color: #ff4d4f;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 标签页导航 -->
        <div class="tab-nav">
            <div class="tab-item active" data-tab="query-tab">经络穴位一键查询</div>
            <div class="tab-item" data-tab="summary-tab">十二正经穴位汇总表</div>
        </div>

        <!-- 一键查询标签页 -->
        <div class="tab-content active" id="query-tab">
            <!-- 查询输入区 -->
            <div class="query-area">
                <div class="query-title">查询条件：</div>
                    <!-- 新增：包裹两个查询项的容器 -->
                <div class="query-items-container">
                    <div class="query-item">
                        <label>经络名称：</label>
                        <select id="meridian" class="color-input">
                            <option value="">-- 请选择经络 --</option>
                            <option value="三焦经">三焦经</option>
                            <option value="心包经">心包经</option>
                            <option value="胆经">胆经</option>
                            <option value="肝经">肝经</option>
                            <option value="肺经">肺经</option>
                            <option value="大肠经">大肠经</option>
                            <option value="心经">心经</option>
                            <option value="小肠经">小肠经</option>
                            <option value="肾经">肾经</option>
                            <option value="膀胱经">膀胱经</option>
                            <option value="胃经">胃经</option>
                            <option value="脾经">脾经</option>
                        </select>
                    </div>
                    <div class="query-item">
                        <label>季节/周期：</label>
                        <select id="season" class="color-input">
                            <option value="">-- 请选择季节/周期 --</option>
                            <option value="冬至~夏至">冬至~夏至</option>
                            <option value="夏至~冬至">夏至~冬至</option>
                            <option value="春（2-4月）">春（2-4月）</option>
                            <option value="秋（8-10月）">秋（8-10月）</option>
                            <option value="夏（5-7月）">夏（5-7月）</option>
                            <option value="冬（11-1月）">冬（11-1月）</option>
                            <option value="四季">四季</option>
                        </select>
                    </div>
                </div>
                <button class="btn-query" onclick="queryAcupoint()">一键查询</button>
            </div>

            <!-- 查询结果区 -->
            <table class="result-area">
                <tr>
                    <td colspan="2" class="result-cell result-title">查询结果</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-green">动态五行</td>
                    <td class="result-cell color-green" id="res-wuxing">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-green">子母穴位</td>
                    <td class="result-cell color-green" id="res-zimu">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-green">五行逻辑</td>
                    <td class="result-cell color-green" id="res-logic">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-pink">补母穴位置</td>
                    <td class="result-cell color-pink" id="res-bumu-loc">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-pink">补母穴治证</td>
                    <td class="result-cell color-pink" id="res-bumu-func">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-pink">补母穴配穴治证</td>
                    <td class="result-cell color-pink" id="res-bumu-pei">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-blue">泻子穴位置</td>
                    <td class="result-cell color-blue" id="res-xiezi-loc">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-blue">泻子穴治证</td>
                    <td class="result-cell color-blue" id="res-xiezi-func">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-blue">泻子穴配穴治证</td>
                    <td class="result-cell color-blue" id="res-xiezi-pei">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-yellow">原穴五行属性</td>
                    <td class="result-cell color-yellow" id="res-yuan-wuxing">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-yellow">原穴取穴位置</td>
                    <td class="result-cell color-yellow" id="res-yuan-loc">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-yellow">原穴治证</td>
                    <td class="result-cell color-yellow" id="res-yuan-func">请选择条件并点击查询</td>
                </tr>
                <tr>
                    <td class="result-cell result-label color-yellow">原穴配穴</td>
                    <td class="result-cell color-yellow" id="res-yuan-pei">请选择条件并点击查询</td>
                </tr>
            </table>
        </div>

        <!-- 汇总表标签页 -->
        <div class="tab-content" id="summary-tab">
            <h3 style="text-align: center; margin-bottom: 10px;">十二正经穴位汇总表（完整无省略）</h3>
            <div class="summary-table">
                <table>
                    <thead>
                        <tr>
                            <th class="summary-th">经络名称</th>
                            <th class="summary-th">季节/周期</th>
                            <th class="summary-th">动态五行</th>
                            <th class="summary-th">子母穴位（补母泻子）</th>
                            <th class="summary-th">五行逻辑</th>
                            <th class="summary-th">原穴</th>
                            <th class="summary-th">原穴五行属性</th>
                            <th class="summary-th">原穴取穴位置</th>
                            <th class="summary-th">原穴治证</th>
                            <th class="summary-th">原穴配穴</th>
                            <th class="summary-th">补母穴位置</th>
                            <th class="summary-th">补母穴治证</th>
                            <th class="summary-th">泻子穴位置</th>
                            <th class="summary-th">泻子穴治证</th>
                            <th class="summary-th">补母穴配穴</th>
                            <th class="summary-th">补母穴配穴治证</th>
                            <th class="summary-th">泻子穴配穴</th>
                            <th class="summary-th">泻子穴配穴治证</th>
                        </tr>
                    </thead>
                    <tbody id="summary-body">
                        <!-- 由JS自动渲染数据 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // ======================================
        // 核心数据 - 完全还原原VBA的所有数组数据
        // ======================================
        const allData = [
            // 三焦经-冬至~夏至
            {
                meridian: "三焦经", season: "冬至~夏至", wuxing: "水",
                zimu: "补母穴：关冲（井金） | 泻子穴：中渚（输木）", logic: "金生水（补），水生木（泻）",
                yuanName: "阳池", yuanWuxing: "阳池（原穴，属土）",
                yuanLoc: "在腕后区，腕背侧横纹上，指伸肌腱的尺侧缘凹陷中",
                yuanFunc: "目赤肿痛，耳聋耳鸣，喉痹，口干，腕痛，肩臂痛",
                yuanPei: "配外关、曲池治腕臂痛；配翳风、听会治耳鸣耳聋；配少商、合谷治喉痹",
                buMuLoc: "关冲：在手环指末节尺侧，距指甲角0.1寸（指寸）",
                buMuFunc: "关冲：头痛，目赤，耳聋，耳鸣，喉痹，舌强，热病，中暑",
                xieZiLoc: "中渚：在手背部，第4、5掌骨间，第4掌指关节近端凹陷中",
                xieZiFunc: "中渚：头痛，目赤，耳鸣，耳聋，喉痹，肩背肘臂酸痛，手指不能屈伸，热病",
                buMuPei: "关冲配少商、商阳",
                buMuPeiFunc: "关冲配少商、商阳治咽喉肿痛；配人中、劳宫治中暑昏迷；配风池、太阳治头痛目赤",
                xieZiPei: "中渚配肩髃、曲池",
                xieZiPeiFunc: "中渚配肩髃、曲池治肩背肘臂酸痛；配听宫、翳风治耳鸣耳聋；配太冲、行间治头痛目赤"
            },
            // 三焦经-夏至~冬至
            {
                meridian: "三焦经", season: "夏至~冬至", wuxing: "火",
                zimu: "补母穴：中渚（输木） | 泻子穴：天井（合土）", logic: "木生火（补），火生土（泻）",
                yuanName: "阳池", yuanWuxing: "阳池（原穴，属土）",
                yuanLoc: "在腕后区，腕背侧横纹上，指伸肌腱的尺侧缘凹陷中",
                yuanFunc: "目赤肿痛，耳聋耳鸣，喉痹，口干，腕痛，肩臂痛",
                yuanPei: "配外关、曲池治腕臂痛；配翳风、听会治耳鸣耳聋；配少商、合谷治喉痹",
                buMuLoc: "中渚：在手背部，第4、5掌骨间，第4掌指关节近端凹陷中",
                buMuFunc: "中渚：头痛，目赤，耳鸣，耳聋，喉痹，肩背肘臂酸痛，手指不能屈伸，热病",
                xieZiLoc: "天井：在肘后区，肘尖上1寸凹陷中",
                xieZiFunc: "天井：偏头痛，胁肋、颈项、肩臂痛，耳聋，瘰疬，瘾疹，癫痫",
                buMuPei: "中渚配外关、支沟",
                buMuPeiFunc: "中渚配外关、支沟治胁肋痛；配后溪、天柱治颈项强痛；配睛明治目赤肿痛",
                xieZiPei: "天井配曲池、臂臑",
                xieZiPeiFunc: "天井配曲池、臂臑治肩臂痛；配膻中、期门治胁肋痛；配百会、人中治癫痫"
            },
            // 心包经-冬至~夏至
            {
                meridian: "心包经", season: "冬至~夏至", wuxing: "水",
                zimu: "补母穴：间使（经金） | 泻子穴：中冲（井木）", logic: "金生水（补），水生木（泻）",
                yuanName: "大陵", yuanWuxing: "大陵（原穴，属土）",
                yuanLoc: "在腕前区，腕掌侧横纹中，掌长肌腱与桡侧腕屈肌腱之间",
                yuanFunc: "心痛，心悸，胃痛，呕吐，癫狂痫，腕关节痛，失眠",
                yuanPei: "配内关、神门治心痛心悸；配人中、丰隆治癫狂痫；配足三里治胃痛呕吐",
                buMuLoc: "间使：在前臂前区，腕掌侧远端横纹上3寸，掌长肌腱与桡侧腕屈肌腱之间",
                buMuFunc: "间使：心痛，心悸，胃痛，呕吐，热病，疟疾，癫狂痫，腋肿，肘挛",
                xieZiLoc: "中冲：在手中指末节尖端中央",
                xieZiFunc: "中冲：中风昏迷，舌强不语，中暑，晕厥，小儿惊风，热病，舌下肿痛",
                buMuPei: "间使配内关、心俞",
                buMuPeiFunc: "间使配内关、心俞治心痛心悸；配大椎、曲池治热病疟疾；配丰隆、百会治癫狂痫",
                xieZiPei: "中冲配水沟、太冲",
                xieZiPeiFunc: "中冲配水沟、太冲治小儿惊风；配内关、膻中治心痛；配劳宫、曲泽治中暑晕厥"
            },
            // 心包经-夏至~冬至
            {
                meridian: "心包经", season: "夏至~冬至", wuxing: "火",
                zimu: "补母穴：中冲（井木） | 泻子穴：大陵（输土）", logic: "木生火（补），火生土（泻）",
                yuanName: "大陵", yuanWuxing: "大陵（原穴，属土）",
                yuanLoc: "在腕前区，腕掌侧横纹中，掌长肌腱与桡侧腕屈肌腱之间",
                yuanFunc: "心痛，心悸，胃痛，呕吐，癫狂痫，腕关节痛，失眠",
                yuanPei: "配内关、神门治心痛心悸；配人中、丰隆治癫狂痫；配足三里治胃痛呕吐",
                buMuLoc: "中冲：在手中指末节尖端中央",
                buMuFunc: "中冲：中风昏迷，舌强不语，中暑，晕厥，小儿惊风，热病，舌下肿痛",
                xieZiLoc: "大陵：在腕前区，腕掌侧横纹中，掌长肌腱与桡侧腕屈肌腱之间",
                xieZiFunc: "大陵：心痛，心悸，胃痛，呕吐，癫狂痫，腕关节痛，失眠",
                buMuPei: "中冲配劳宫、涌泉",
                buMuPeiFunc: "中冲配劳宫、涌泉治中暑；配人中、合谷治中风昏迷；配少商、商阳治舌下肿痛",
                xieZiPei: "大陵配内关、膻中",
                xieZiPeiFunc: "大陵配内关、膻中治心痛心悸；配足三里、中脘治胃痛呕吐；配神门、三阴交治失眠"
            },
            // 胆经-春（2-4月）
            {
                meridian: "胆经", season: "春（2-4月）", wuxing: "木",
                zimu: "补母穴：侠溪（荥水） | 泻子穴：阳辅（经火）", logic: "水生木（补），木生火（泻）",
                yuanName: "丘墟", yuanWuxing: "丘墟（原穴，属木）",
                yuanLoc: "在足背外侧，第4、5跖骨底结合部的前方，骰骨外侧凹陷中",
                yuanFunc: "目赤肿痛，偏头痛，外踝肿痛，胁痛，下肢痿痹",
                yuanPei: "配阳陵泉、期门治胁痛；配外关、太阳治偏头痛；配昆仑治外踝肿痛",
                buMuLoc: "侠溪：在足背第4、5趾间，趾蹼缘后方赤白肉际处",
                buMuFunc: "侠溪：头痛，眩晕，目赤肿痛，耳鸣，耳聋，颊肿，胁痛，膝股痛，足跗肿痛，疟疾",
                xieZiLoc: "阳辅：在小腿外侧，外踝尖上4寸，腓骨前缘稍前方",
                xieZiFunc: "阳辅：偏头痛，目外眦痛，缺盆中痛，腋下痛，瘰疬，胸胁、下肢外侧痛，疟疾",
                buMuPei: "侠溪配太冲、太阳",
                buMuPeiFunc: "侠溪配太冲、太阳治偏头痛；配听会、翳风治耳鸣耳聋；配阳陵泉、期门治胁痛",
                xieZiPei: "阳辅配环跳、阳陵泉",
                xieZiPeiFunc: "阳辅配环跳、阳陵泉治下肢外侧痛；配外关、天井治腋下肿痛；配大椎、间使治疟疾"
            },
            // 胆经-秋（8-10月）
            {
                meridian: "胆经", season: "秋（8-10月）", wuxing: "金",
                zimu: "补母穴：窍阴（井金） | 泻子穴：侠溪（荥水）", logic: "金生水（补，本穴为母）",
                yuanName: "丘墟", yuanWuxing: "丘墟（原穴，属木）",
                yuanLoc: "在足背外侧，第4、5跖骨底结合部的前方，骰骨外侧凹陷中",
                yuanFunc: "目赤肿痛，偏头痛，外踝肿痛，胁痛，下肢痿痹",
                yuanPei: "配阳陵泉、期门治胁痛；配外关、太阳治偏头痛；配昆仑治外踝肿痛",
                buMuLoc: "足窍阴：在足第4趾末节外侧，距指甲角0.1寸（指寸）",
                buMuFunc: "足窍阴：头痛，眩晕，目赤肿痛，耳鸣，耳聋，喉痹，舌强，胁痛，足跗肿痛，热病，失眠",
                xieZiLoc: "侠溪：在足背第4、5趾间，趾蹼缘后方赤白肉际处",
                xieZiFunc: "侠溪：头痛，眩晕，目赤肿痛，耳鸣，耳聋，颊肿，胁痛，膝股痛，足跗肿痛，疟疾",
                buMuPei: "足窍阴配风池、头维",
                buMuPeiFunc: "足窍阴配风池、头维治偏头痛；配听宫、耳门治耳鸣耳聋；配太冲、行间治目赤肿痛",
                xieZiPei: "侠溪配阳陵泉、支沟",
                xieZiPeiFunc: "侠溪配阳陵泉、支沟治胁痛；配足三里、丰隆治眩晕；配内庭、厉兑治颊肿"
            },
            // 肝经-春（2-4月）
            {
                meridian: "肝经", season: "春（2-4月）", wuxing: "木",
                zimu: "补母穴：曲泉（合水） | 泻子穴：行间（荥火）", logic: "水生木（补），木生火（泻）",
                yuanName: "太冲", yuanWuxing: "太冲（原穴，属土）",
                yuanLoc: "在足背，第1、2跖骨间，跖骨底结合部前方凹陷中，或触及动脉搏动",
                yuanFunc: "头痛，眩晕，目赤肿痛，胁痛，月经不调，痛经，小儿惊风，下肢痿痹",
                yuanPei: "配行间、风池治头痛眩晕；配期门、肝俞治胁痛；配三阴交治月经不调",
                buMuLoc: "曲泉：在膝部，腘横纹内侧端，半腱肌肌腱内缘凹陷中",
                buMuFunc: "曲泉：月经不调，痛经，带下，阴挺，阴痒，产后腹痛，遗精，阳痿，疝气，小便不利，头痛，目眩，癫狂，膝股痛",
                xieZiLoc: "行间：在足背第1、2趾间，趾蹼缘的后方赤白肉际处",
                xieZiFunc: "行间：头痛，眩晕，目赤肿痛，青盲，口喎，胁痛，疝气，小便不利，崩漏，癫痫，月经不调，痛经，带下，中风",
                buMuPei: "曲泉配三阴交、中极",
                buMuPeiFunc: "曲泉配三阴交、中极治月经不调、痛经；配关元、气海治疝气；配肾俞、腰阳关治腰膝痛",
                xieZiPei: "行间配太冲、风池",
                xieZiPeiFunc: "行间配太冲、风池治头痛眩晕；配期门、肝俞治胁痛；配血海、三阴交治月经不调"
            },
            // 肝经-秋（8-10月）
            {
                meridian: "肝经", season: "秋（8-10月）", wuxing: "金",
                zimu: "补母穴：中封（经金） | 泻子穴：曲泉（合水）", logic: "金生水（补），水生木（泻）",
                yuanName: "太冲", yuanWuxing: "太冲（原穴，属土）",
                yuanLoc: "在足背，第1、2跖骨间，跖骨底结合部前方凹陷中，或触及动脉搏动",
                yuanFunc: "头痛，眩晕，目赤肿痛，胁痛，月经不调，痛经，小儿惊风，下肢痿痹",
                yuanPei: "配行间、风池治头痛眩晕；配期门、肝俞治胁痛；配三阴交治月经不调",
                buMuLoc: "中封：在踝区，内踝前，胫骨前肌腱内侧缘凹陷中",
                buMuFunc: "中封：疝气，遗精，阳痿，阴茎痛，小便不利，黄疸，胸腹胀满，腰痛，足冷，内踝肿痛",
                xieZiLoc: "曲泉：在膝部，腘横纹内侧端，半腱肌肌腱内缘凹陷中",
                xieZiFunc: "曲泉：月经不调，痛经，带下，阴挺，阴痒，产后腹痛，遗精，阳痿，疝气，小便不利，头痛，目眩，癫狂，膝股痛",
                buMuPei: "中封配太冲、曲泉",
                buMuPeiFunc: "中封配太冲、曲泉治疝气；配阴陵泉、三阴交治小便不利；配足三里、阳陵泉治下肢痿痹",
                xieZiPei: "曲泉配关元、三阴交",
                xieZiPeiFunc: "曲泉配关元、三阴交治月经不调；配肾俞、命门治阳痿遗精；配委中、阳陵泉治膝股痛"
            },
            // 肺经-春（2-4月）
            {
                meridian: "肺经", season: "春（2-4月）", wuxing: "木",
                zimu: "补母穴：少商（井木） | 泻子穴：鱼际（荥火）", logic: "木生火（补，本穴为母）",
                yuanName: "太渊", yuanWuxing: "太渊（原穴，属土）",
                yuanLoc: "在腕掌侧横纹桡侧，桡动脉搏动处",
                yuanFunc: "咳嗽，气喘，咯血，咽痛，腕痛，无脉症",
                yuanPei: "配列缺、合谷治咳嗽咽痛；配内关、尺泽治咯血；配人迎治无脉症",
                buMuLoc: "少商：在手指，拇指末节桡侧，距指甲角0.1寸（指寸）",
                buMuFunc: "少商：咽喉肿痛，喉痹，咳嗽，气喘，鼻衄，发热，昏迷，癫狂，中风昏迷",
                xieZiLoc: "鱼际：在手外侧，第1掌骨桡侧中点赤白肉际处",
                xieZiFunc: "鱼际：咳嗽，气喘，咯血，咽痛，失音，掌中热，小儿疳积",
                buMuPei: "少商配商阳、合谷",
                buMuPeiFunc: "少商配商阳、合谷治咽喉肿痛；配水沟、涌泉治中风昏迷；配尺泽、肺俞治咳嗽气喘",
                xieZiPei: "鱼际配尺泽、列缺",
                xieZiPeiFunc: "鱼际配尺泽、列缺治咳嗽气喘；配少商、合谷治咽痛失音；配脾俞、足三里治小儿疳积"
            },
            // 肺经-秋（8-10月）
            {
                meridian: "肺经", season: "秋（8-10月）", wuxing: "金",
                zimu: "补母穴：太渊（输土） | 泻子穴：复溜（经金）", logic: "土生金（补），金生水（泻）",
                yuanName: "太渊", yuanWuxing: "太渊（原穴，属土）",
                yuanLoc: "在腕掌侧横纹桡侧，桡动脉搏动处",
                yuanFunc: "咳嗽，气喘，咯血，咽痛，腕痛，无脉症",
                yuanPei: "配列缺、合谷治咳嗽咽痛；配内关、尺泽治咯血；配人迎治无脉症",
                buMuLoc: "太渊：在腕掌侧横纹桡侧，桡动脉搏动处",
                buMuFunc: "太渊：咳嗽，气喘，咯血，咽痛，腕痛，无脉症",
                xieZiLoc: "复溜：在小腿内侧，内踝尖上2寸，跟腱的前缘",
                xieZiFunc: "复溜：水肿，腹胀，泄泻，盗汗，热病汗不出，下肢痿痹，腰脊强痛",
                buMuPei: "太渊配肺俞、列缺",
                buMuPeiFunc: "太渊配肺俞、列缺治咳嗽气喘；配内关、膈俞治咯血；配人迎、太冲治无脉症",
                xieZiPei: "复溜配肾俞、关元",
                xieZiPeiFunc: "复溜配肾俞、关元治盗汗；配足三里、天枢治腹胀泄泻；配阳陵泉、昆仑治下肢痿痹"
            },
            // 大肠经-春（2-4月）
            {
                meridian: "大肠经", season: "春（2-4月）", wuxing: "木",
                zimu: "补母穴：商阳（井金） | 泻子穴：三间（输木）", logic: "金生水（补），水生木（泻）",
                yuanName: "合谷", yuanWuxing: "合谷（原穴，属木）",
                yuanLoc: "在手背，第2掌骨桡侧的中点处（虎口凹陷中）",
                yuanFunc: "头痛，目赤肿痛，鼻衄，齿痛，牙关紧闭，面瘫，发热，便秘",
                yuanPei: "配曲池、大椎治发热；配地仓、颊车治面瘫；配迎香治鼻衄",
                buMuLoc: "商阳：在手指，食指末节桡侧，距指甲角0.1寸（指寸）",
                buMuFunc: "商阳：齿痛，咽喉肿痛，颌肿，目赤，耳聋，耳鸣，热病，昏迷，手指麻木",
                xieZiLoc: "三间：在手背，第2掌指关节桡侧近端凹陷中",
                xieZiFunc: "三间：咽喉肿痛，齿痛，目痛，鼻衄，口干，口喎，热病，手指肿痛，屈伸不利",
                buMuPei: "商阳配少商、合谷",
                buMuPeiFunc: "商阳配少商、合谷治咽喉肿痛；配水沟、内关治热病昏迷；配迎香、印堂治鼻衄",
                xieZiPei: "三间配合谷、阳溪",
                xieZiPeiFunc: "三间配合谷、阳溪治齿痛；配曲池、外关治热病；配后溪、养老治手指屈伸不利"
            },
            // 大肠经-秋（8-10月）
            {
                meridian: "大肠经", season: "秋（8-10月）", wuxing: "金",
                zimu: "补母穴：曲池（合土） | 泻子穴：二间（荥水）", logic: "土生金（补），金生水（泻）",
                yuanName: "合谷", yuanWuxing: "合谷（原穴，属木）",
                yuanLoc: "在手背，第2掌骨桡侧的中点处（虎口凹陷中）",
                yuanFunc: "头痛，目赤肿痛，鼻衄，齿痛，牙关紧闭，面瘫，发热，便秘",
                yuanPei: "配曲池、大椎治发热；配地仓、颊车治面瘫；配迎香治鼻衄",
                buMuLoc: "曲池：在肘区，尺泽与肱骨外上髁连线的中点处",
                buMuFunc: "曲池：手臂肿痛，上肢不遂，热病，眩晕，腹痛，吐泻，痢疾，咽喉肿痛，齿痛，目赤痛，瘾疹，湿疹，瘰疬",
                xieZiLoc: "二间：在手背，第2掌指关节桡侧远端凹陷中",
                xieZiFunc: "二间：咽喉肿痛，齿痛，目痛，鼻衄，口干，口喎，热病，手指肿痛，屈伸不利",
                buMuPei: "曲池配合谷、大椎",
                buMuPeiFunc: "曲池配合谷、大椎治发热；配血海、膈俞治瘾疹；配足三里、中脘治腹痛吐泻",
                xieZiPei: "二间配合谷、内庭",
                xieZiPeiFunc: "二间配合谷、内庭治齿痛；配少商、商阳治咽喉肿痛；配阳溪、养老治手指肿痛"
            },
            // 心经-夏（5-7月）
            {
                meridian: "心经", season: "夏（5-7月）", wuxing: "火",
                zimu: "补母穴：少冲（井木） | 泻子穴：神门（输土）", logic: "木生火（补），火生土（泻）",
                yuanName: "神门", yuanWuxing: "神门（原穴，属土）",
                yuanLoc: "在腕前区，腕掌侧横纹尺侧端，尺侧腕屈肌腱的桡侧凹陷中",
                yuanFunc: "心痛，心悸，失眠，健忘，癫狂痫，掌中热",
                yuanPei: "配内关、膻中治心痛心悸；配三阴交、百会治失眠健忘；配人中治癫狂痫",
                buMuLoc: "少冲：在手指，小指末节桡侧，距指甲角0.1寸（指寸）",
                buMuFunc: "少冲：心悸，心痛，胸胁痛，癫狂，热病，昏迷，手指麻木",
                xieZiLoc: "神门：在腕前区，腕掌侧横纹尺侧端，尺侧腕屈肌腱的桡侧凹陷中",
                xieZiFunc: "神门：心痛，心悸，失眠，健忘，癫狂痫，掌中热",
                buMuPei: "少冲配内关、膻中",
                buMuPeiFunc: "少冲配内关、膻中治心痛心悸；配水沟、太冲治癫狂；配中冲、劳宫治热病昏迷",
                xieZiPei: "神门配三阴交、百会",
                xieZiPeiFunc: "神门配三阴交、百会治失眠健忘；配心俞、厥阴俞治心痛；配内关、足三里治心悸"
            },
            // 心经-冬（11-1月）
            {
                meridian: "心经", season: "冬（11-1月）", wuxing: "水",
                zimu: "补母穴：灵道（经金） | 泻子穴：少冲（井木）", logic: "金生水（补），水生木（泻）",
                yuanName: "神门", yuanWuxing: "神门（原穴，属土）",
                yuanLoc: "在腕前区，腕掌侧横纹尺侧端，尺侧腕屈肌腱的桡侧凹陷中",
                yuanFunc: "心痛，心悸，失眠，健忘，癫狂痫，掌中热",
                yuanPei: "配内关、膻中治心痛心悸；配三阴交、百会治失眠健忘；配人中治癫狂痫",
                buMuLoc: "灵道：在前臂前区，腕掌侧远端横纹上1.5寸，尺侧腕屈肌腱的桡侧缘",
                buMuFunc: "灵道：心痛，心悸，怔忡，暴喑，舌强不语，腕臂痛",
                xieZiLoc: "少冲：在手指，小指末节桡侧，距指甲角0.1寸（指寸）",
                xieZiFunc: "少冲：心悸，心痛，胸胁痛，癫狂，热病，昏迷，手指麻木",
                buMuPei: "灵道配神门、心俞",
                buMuPeiFunc: "灵道配神门、心俞治心痛心悸；配廉泉、哑门治暴喑；配外关、曲池治腕臂痛",
                xieZiPei: "少冲配劳宫、人中",
                xieZiPeiFunc: "少冲配劳宫、人中治热病昏迷；配内关、膈俞治胸胁痛；配神门、三阴交治失眠"
            },
            // 小肠经-夏（5-7月）
            {
                meridian: "小肠经", season: "夏（5-7月）", wuxing: "火",
                zimu: "补母穴：后溪（输木） | 泻子穴：小海（合土）", logic: "木生火（补），火生土（泻）",
                yuanName: "腕骨", yuanWuxing: "腕骨（原穴，属木）",
                yuanLoc: "在腕区，第5掌骨底与三角骨之间的赤白肉际凹陷中",
                yuanFunc: "头痛，项强，目翳，耳聋，指挛腕痛，消渴，腹泻",
                yuanPei: "配后溪、天柱治项强；配听宫、翳风治耳聋；配曲池治腕痛",
                buMuLoc: "后溪：在手内侧，第5掌指关节尺侧近端赤白肉际凹陷中",
                buMuFunc: "后溪：头痛，项强，目赤，耳聋，咽喉肿痛，腰背痛，手指及肘臂挛痛，癫狂痫，疟疾",
                xieZiLoc: "小海：在肘后区，尺骨鹰嘴与肱骨内上髁之间凹陷中",
                xieZiFunc: "小海：肘臂疼痛，麻木，癫痫",
                buMuPei: "后溪配天柱、大椎",
                buMuPeiFunc: "后溪配天柱、大椎治项强；配听宫、耳门治耳聋；配委中、昆仑治腰背痛",
                xieZiPei: "小海配曲池、尺泽",
                xieZiPeiFunc: "小海配曲池、尺泽治肘臂痛；配百会、人中治癫痫；配外关、合谷治麻木"
            },
            // 小肠经-冬（11-1月）
            {
                meridian: "小肠经", season: "冬（11-1月）", wuxing: "水",
                zimu: "补母穴：少泽（井金） | 泻子穴：后溪（输木）", logic: "金生水（补），水生木（泻）",
                yuanName: "腕骨", yuanWuxing: "腕骨（原穴，属木）",
                yuanLoc: "在腕区，第5掌骨底与三角骨之间的赤白肉际凹陷中",
                yuanFunc: "头痛，项强，目翳，耳聋，指挛腕痛，消渴，腹泻",
                yuanPei: "配后溪、天柱治项强；配听宫、翳风治耳聋；配曲池治腕痛",
                buMuLoc: "少泽：在手指，小指末节尺侧，距指甲角0.1寸（指寸）",
                buMuFunc: "少泽：乳痈，乳汁少，昏迷，热病，头痛，目翳，咽喉肿痛，耳鸣，耳聋，指端麻木",
                xieZiLoc: "后溪：在手内侧，第5掌指关节尺侧近端赤白肉际凹陷中",
                xieZiFunc: "后溪：头痛，项强，目赤，耳聋，咽喉肿痛，腰背痛，手指及肘臂挛痛，癫狂痫，疟疾",
                buMuPei: "少泽配膻中、乳根",
                buMuPeiFunc: "少泽配膻中、乳根治乳痈乳汁少；配水沟、内关治热病昏迷；配睛明、太阳治目翳头痛",
                xieZiPei: "后溪配列缺、合谷",
                xieZiPeiFunc: "后溪配列缺、合谷治头痛项强；配腰阳关、委中治腰背痛；配太冲、内关治癫狂痫"
            },
            // 肾经-夏（5-7月）
            {
                meridian: "肾经", season: "夏（5-7月）", wuxing: "火",
                zimu: "补母穴：涌泉（井木） | 泻子穴：太溪（输土）", logic: "木生火（补），火生土（泻）",
                yuanName: "太溪", yuanWuxing: "太溪（原穴，属土）",
                yuanLoc: "在足内侧，内踝尖与跟腱之间的凹陷中",
                yuanFunc: "头晕，耳鸣，耳聋，腰膝酸软，遗精，阳痿，月经不调，消渴，小便频数",
                yuanPei: "配涌泉、三阴交治月经不调；配腰阳关治腰膝酸软；配内庭治消渴",
                buMuLoc: "涌泉：在足底，屈足卷趾时足心最凹陷中",
                buMuFunc: "涌泉：昏厥，中暑，癫痫，小儿惊风，头痛，头晕，目眩，失眠，咯血，咽喉肿痛，失音，便秘，小便不利，足心热，奔豚气",
                xieZiLoc: "太溪：在足内侧，内踝尖与跟腱之间的凹陷中",
                xieZiFunc: "太溪：头晕，耳鸣，耳聋，腰膝酸软，遗精，阳痿，月经不调，消渴，小便频数，便秘，腰脊痛，下肢厥冷，内踝肿痛",
                buMuPei: "涌泉配百会、人中",
                buMuPeiFunc: "涌泉配百会、人中治昏厥中暑；配太冲、内关治失眠眩晕；配三阴交、关元治月经不调",
                xieZiPei: "太溪配肾俞、命门",
                xieZiPeiFunc: "太溪配肾俞、命门治腰膝酸软阳痿；配三阴交、血海治月经不调；配内庭、脾俞治消渴"
            },
            // 肾经-冬（11-1月）
            {
                meridian: "肾经", season: "冬（11-1月）", wuxing: "水",
                zimu: "补母穴：复溜（经金） | 泻子穴：涌泉（井木）", logic: "金生水（补），水生木（泻）",
                yuanName: "太溪", yuanWuxing: "太溪（原穴，属土）",
                yuanLoc: "在足内侧，内踝尖与跟腱之间的凹陷中",
                yuanFunc: "头晕，耳鸣，耳聋，腰膝酸软，遗精，阳痿，月经不调，消渴，小便频数",
                yuanPei: "配涌泉、三阴交治月经不调；配腰阳关治腰膝酸软；配内庭治消渴",
                buMuLoc: "复溜：在小腿内侧，内踝尖上2寸，跟腱的前缘",
                buMuFunc: "复溜：水肿，腹胀，泄泻，盗汗，热病汗不出，下肢痿痹，腰脊强痛",
                xieZiLoc: "涌泉：在足底，屈足卷趾时足心最凹陷中",
                xieZiFunc: "涌泉：昏厥，中暑，癫痫，小儿惊风，头痛，头晕，目眩，失眠，咯血，咽喉肿痛，失音，便秘，小便不利，足心热，奔豚气",
                buMuPei: "复溜配太溪、肾俞",
                buMuPeiFunc: "复溜配太溪、肾俞治盗汗腰膝痛；配足三里、天枢治腹胀泄泻；配阳陵泉、昆仑治下肢痿痹",
                xieZiPei: "涌泉配关元、气海",
                xieZiPeiFunc: "涌泉配关元、气海治小便不利奔豚气；配劳宫、人中治中暑；配太溪、三阴交治头晕耳鸣"
            },
            // 膀胱经-夏（5-7月）
            {
                meridian: "膀胱经", season: "夏（5-7月）", wuxing: "火",
                zimu: "补母穴：束骨（输木） | 泻子穴：委中（合土）", logic: "木生火（补），火生土（泻）",
                yuanName: "京骨", yuanWuxing: "京骨（原穴，属木）",
                yuanLoc: "在足外侧，第5跖骨粗隆下方，赤白肉际处",
                yuanFunc: "头痛，项强，目翳，癫痫，腰腿痛，下肢痿痹",
                yuanPei: "配昆仑、委中治腰腿痛；配风池、太阳治头痛；配人中治癫痫",
                buMuLoc: "束骨：在足外侧，第5跖骨小头的后缘，赤白肉际处",
                buMuFunc: "束骨：头痛，项强，目眩，腰背痛，下肢痿痹，癫狂，痈疽，疔疮",
                xieZiLoc: "委中：在膝后区，腘横纹中点",
                xieZiFunc: "委中：腰背痛，下肢痿痹，腹痛，急性吐泻，小便不利，遗尿，丹毒，瘾疹，皮肤瘙痒",
                buMuPei: "束骨配天柱、后溪",
                buMuPeiFunc: "束骨配天柱、后溪治头痛项强；配昆仑、承山治腰背痛；配太冲、行间治目眩",
                xieZiPei: "委中配大肠俞、腰阳关",
                xieZiPeiFunc: "委中配大肠俞、腰阳关治腰背痛；配曲池、血海治瘾疹丹毒；配中脘、足三里治急性吐泻"
            },
            // 膀胱经-冬（11-1月）
            {
                meridian: "膀胱经", season: "冬（11-1月）", wuxing: "水",
                zimu: "补母穴：至阴（井金） | 泻子穴：束骨（输木）", logic: "金生水（补），水生木（泻）",
                yuanName: "京骨", yuanWuxing: "京骨（原穴，属木）",
                yuanLoc: "在足外侧，第5跖骨粗隆下方，赤白肉际处",
                yuanFunc: "头痛，项强，目翳，癫痫，腰腿痛，下肢痿痹",
                yuanPei: "配昆仑、委中治腰腿痛；配风池、太阳治头痛；配人中治癫痫",
                buMuLoc: "至阴：在足小趾末节外侧，距趾甲角0.1寸（指寸）",
                buMuFunc: "至阴：头痛，目痛，鼻塞，鼻衄，胎位不正，难产，胞衣不下，小儿惊风，热病",
                xieZiLoc: "束骨：在足外侧，第5跖骨小头的后缘，赤白肉际处",
                xieZiFunc: "束骨：头痛，项强，目眩，腰背痛，下肢痿痹，癫狂，痈疽，疔疮",
                buMuPei: "至阴配太冲、合谷",
                buMuPeiFunc: "至阴配太冲、合谷治胎位不正难产；配风池、太阳治头痛目痛；配迎香、印堂治鼻衄",
                xieZiPei: "束骨配昆仑、申脉",
                xieZiPeiFunc: "束骨配昆仑、申脉治下肢痿痹；配百会、人中治癫狂；配天柱、大椎治项强"
            },
            // 胃经-四季
            {
                meridian: "胃经", season: "四季", wuxing: "土",
                zimu: "补母穴：解溪（经火） | 泻子穴：厉兑（井金）", logic: "火生土（补），土生金（泻）",
                yuanName: "冲阳", yuanWuxing: "冲阳（原穴，属土）",
                yuanLoc: "在足背最高点，当拇长伸肌腱和趾长伸肌腱之间，足背动脉搏动处",
                yuanFunc: "胃痛，腹胀，口眼喎斜，面肿，齿痛，足痿无力，发热",
                yuanPei: "配足三里、内庭治胃痛；配地仓、颊车治口眼喎斜；配内庭治齿痛",
                buMuLoc: "解溪：在踝区，踝关节前面中央凹陷中，拇长伸肌腱与趾长伸肌腱之间",
                buMuFunc: "解溪：头痛，眩晕，癫狂，腹胀，便秘，下肢痿痹，足踝肿痛",
                xieZiLoc: "厉兑：在足第2趾末节外侧，距趾甲角0.1寸（指寸）",
                xieZiFunc: "厉兑：鼻衄，齿痛，咽喉肿痛，腹胀，热病，多梦，癫狂",
                buMuPei: "解溪配足三里、中脘",
                buMuPeiFunc: "解溪配足三里、中脘治胃痛腹胀；配太冲、风池治头痛眩晕；配阳陵泉、昆仑治下肢痿痹",
                xieZiPei: "厉兑配内庭、合谷",
                xieZiPeiFunc: "厉兑配内庭、合谷治齿痛咽喉肿痛；配百会、神门治多梦癫狂；配曲池、大椎治热病"
            },
            // 脾经-四季
            {
                meridian: "脾经", season: "四季", wuxing: "土",
                zimu: "补母穴：大都（荥火） | 泻子穴：商丘（经金）", logic: "火生土（补），土生金（泻）",
                yuanName: "太白", yuanWuxing: "太白（原穴，属土）",
                yuanLoc: "在足内侧缘，第1跖骨小头后下方凹陷中",
                yuanFunc: "胃痛，腹胀，泄泻，便秘，痢疾，脚气，下肢痿痹",
                yuanPei: "配足三里、中脘治胃痛腹胀；配天枢治泄泻；配商丘治脚气",
                buMuLoc: "大都：在足趾，第1跖趾关节远端赤白肉际凹陷中",
                buMuFunc: "大都：腹胀，胃痛，呕吐，泄泻，便秘，热病，无汗，体重节痛，手足逆冷",
                xieZiLoc: "商丘：在踝区，内踝前下方，舟骨粗隆与内踝尖连线的中点凹陷中",
                xieZiFunc: "商丘：腹胀，泄泻，便秘，黄疸，足踝肿痛，舌本强痛，癫狂",
                buMuPei: "大都配足三里、中脘",
                buMuPeiFunc: "大都配足三里、中脘治胃痛腹胀；配曲池、合谷治热病无汗；配阳陵泉、昆仑治体重节痛",
                xieZiPei: "商丘配三阴交、阴陵泉",
                xieZiPeiFunc: "商丘配三阴交、阴陵泉治腹胀泄泻黄疸；配太冲、行间治舌本强痛；配足三里、丰隆治脚气"
            }
        ];

        // ======================================
        // 页面初始化 - 渲染汇总表、标签页切换
        // ======================================
        window.onload = function() {
            // 渲染汇总表数据
            renderSummaryTable();
            // 标签页切换事件
            const tabItems = document.querySelectorAll('.tab-item');
            tabItems.forEach(item => {
                item.addEventListener('click', function() {
                    // 移除所有激活状态
                    tabItems.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    // 添加当前激活状态
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        };

        // 渲染汇总表
        function renderSummaryTable() {
            const tbody = document.getElementById('summary-body');
            allData.forEach(item => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="summary-td">${item.meridian}</td>
                    <td class="summary-td">${item.season}</td>
                    <td class="summary-td">${item.wuxing}</td>
                    <td class="summary-td">${item.zimu}</td>
                    <td class="summary-td">${item.logic}</td>
                    <td class="summary-td">${item.yuanName}</td>
                    <td class="summary-td">${item.yuanWuxing}</td>
                    <td class="summary-td">${item.yuanLoc}</td>
                    <td class="summary-td">${item.yuanFunc}</td>
                    <td class="summary-td">${item.yuanPei}</td>
                    <td class="summary-td">${item.buMuLoc}</td>
                    <td class="summary-td">${item.buMuFunc}</td>
                    <td class="summary-td">${item.xieZiLoc}</td>
                    <td class="summary-td">${item.xieZiFunc}</td>
                    <td class="summary-td">${item.buMuPei}</td>
                    <td class="summary-td">${item.buMuPeiFunc}</td>
                    <td class="summary-td">${item.xieZiPei}</td>
                    <td class="summary-td">${item.xieZiPeiFunc}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ======================================
        // 核心查询函数 - 还原原VBA的查询逻辑
        // ======================================
        function queryAcupoint() {
            // 1. 按钮变色逻辑（保留）
            const btn = document.querySelector('.btn-query');
            btn.classList.remove('clicked');
            void btn.offsetWidth; // 强制触发重绘
            btn.classList.add('clicked'); // 添加点击态颜色

            // 2. 获取选中值
            const meridian = document.getElementById('meridian').value.trim();
            const season = document.getElementById('season').value.trim();
            
            // 3. 校验输入（恢复未选择条件的alert，保留）
            if (!meridian || !season) {
                alert('请先选择【经络】和【季节/周期】！'); // 保留该提示弹窗
                const resElements = document.querySelectorAll('[id^="res-"]');
                resElements.forEach(ele => ele.innerText = '请选择经络和季节/周期');
                setTimeout(() => btn.classList.remove('clicked'), 3000);
                return;
            }

            // 4. 精准匹配数据
            let foundData = null;
            for (let i = 0; i < allData.length; i++) {
                if (allData[i].meridian === meridian && allData[i].season === season) {
                    foundData = allData[i];
                    break;
                }
            }

            // 5. 填充结果（仅移除“查询成功”的alert，其他保留）
            if (foundData) {
                document.getElementById('res-wuxing').innerText = `经络属性${foundData.wuxing}`;
                document.getElementById('res-zimu').innerText = foundData.zimu;
                document.getElementById('res-logic').innerText = foundData.logic;
                document.getElementById('res-bumu-loc').innerText = foundData.buMuLoc;
                document.getElementById('res-bumu-func').innerText = foundData.buMuFunc;
                document.getElementById('res-bumu-pei').innerText = `补母穴配穴治证：${foundData.buMuPeiFunc}`;
                document.getElementById('res-xiezi-loc').innerText = foundData.xieZiLoc;
                document.getElementById('res-xiezi-func').innerText = foundData.xieZiFunc;
                document.getElementById('res-xiezi-pei').innerText = `泻子穴配穴治证：${foundData.xieZiPeiFunc}`;
                document.getElementById('res-yuan-wuxing').innerText = foundData.yuanWuxing;
                document.getElementById('res-yuan-loc').innerText = `原穴取穴位置：${foundData.yuanLoc}`;
                document.getElementById('res-yuan-func').innerText = `原穴治证：${foundData.yuanFunc}`;
                document.getElementById('res-yuan-pei').innerText = `原穴配穴：${foundData.yuanPei}`;
                // 彻底删除“查询成功”的alert，无任何成功提示
            } else {
                // 保留无匹配结果的提示弹窗（完全保留你指定的内容）
                alert(
                    '无匹配结果！请确认经络与季节的对应规则：\n' +
                    '1. 三焦/心包经：冬至~夏至、夏至~冬至\n' +
                    '2. 胆/肝/肺/大肠经：春（2-4月）、秋（8-10月）\n' +
                    '3. 心/小肠/肾/膀胱经：夏（5-7月）、冬（11-1月）\n' +
                    '4. 胃/脾经：四季'
                );
                // 无匹配时清空结果
                const resElements = document.querySelectorAll('[id^="res-"]');
                resElements.forEach(ele => ele.innerText = '无匹配');
            }

            // 3秒后恢复按钮默认颜色（保留）
            setTimeout(() => btn.classList.remove('clicked'), 3000);
        }
    </script>
</body>
</html>